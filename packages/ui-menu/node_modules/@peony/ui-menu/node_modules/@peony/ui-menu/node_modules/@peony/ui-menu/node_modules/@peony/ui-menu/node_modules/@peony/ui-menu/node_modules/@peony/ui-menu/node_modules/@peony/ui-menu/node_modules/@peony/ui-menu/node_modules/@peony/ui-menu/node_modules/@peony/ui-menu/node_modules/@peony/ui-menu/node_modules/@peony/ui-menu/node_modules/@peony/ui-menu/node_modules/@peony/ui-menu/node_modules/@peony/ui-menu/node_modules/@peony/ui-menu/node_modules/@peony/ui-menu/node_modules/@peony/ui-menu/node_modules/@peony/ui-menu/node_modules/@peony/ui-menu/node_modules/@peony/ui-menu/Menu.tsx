import React, { useState } from "react";
import { MenuItem } from "./types";

interface MenuProps {
  menuData: MenuItem[];
}

export const Menu: React.FC<MenuProps> = ({ menuData }) => {
  const [menuOpen, setMenuOpen] = useState(false);

  return (
    <nav className="relative font-sans">
      {/* Hamburger pro mobil */}
      <div
        className="md:hidden text-2xl cursor-pointer p-2"
        onClick={() => setMenuOpen(!menuOpen)}
      >
        ☰
      </div>

      {/* Menu list */}
      <ul
        className={`md:flex list-none p-0 m-0 ${
          menuOpen ? "block" : "hidden"
        }`}
      >
        {menuData.map((item) => (
          <MenuItemComponent key={item.id} item={item} />
        ))}
      </ul>
    </nav>
  );
};

interface MenuItemProps {
  item: MenuItem;
}

const MenuItemComponent: React.FC<MenuItemProps> = ({ item }) => {
  const [open, setOpen] = useState(false);
  const hasChildren = item.children?.length > 0;

  return (
    <li className="border-b md:border-none relative">
      <div
        className="flex justify-between items-center p-3 cursor-pointer bg-blue-500 text-white rounded hover:bg-blue-600"
        onClick={() => hasChildren && setOpen(!open)}
      >
        <a href={item.url || "#"}>{item.label}</a>
        {hasChildren && <span className={`ml-2 transform ${open ? "rotate-180" : ""}`}>▼</span>}
      </div>

      {hasChildren && open && (
        <ul className="ml-4 mt-1 md:absolute md:left-0 md:top-full md:bg-white md:text-black md:shadow-lg md:rounded md:min-w-[150px]">
          {item.children!.map((child) => (
            <MenuItemComponent key={child.id} item={child} />
          ))}
        </ul>
      )}
    </li>
  );
};
